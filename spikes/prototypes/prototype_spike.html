<html>

<head>
	<script type="text/javascript" src="jquery-1.6.1.js"></script>
</head>
<body>
	<script type="text/javascript">

function log(message) {
	var output = $(".output");
	var li = $("<li></li>");
	li.text(message);
	output.append(li);
}

$(document).ready(function() {
	log("start");

	(function() {
		log();
		log("Prototype basics:");

		var a = {
			foo: function() { log("a.foo"); }
		};

		var b = function() { log("b (function)") };
		b.bar = function() { log("b.bar"); };
		b.toString = function() { return "b.toString"; };

		var c = function() { log("c (function)") };
		c.prototype.baz = function() { log("c.prototype.baz"); };

		a.foo();
		b1 = new b();
		b.bar();
		c1 = new c();
		log("c1 instanceof c: " + (c1 instanceof c));
		log("c1 instanceof b: " + (c1 instanceof b));
		c.prototype = b;
		c2 = new c();
		c1.baz();
		log("c1.__proto__: " + c1.__proto__);
		c2.bar();
		log("c2.__proto__: " + c2.__proto__);

		log("c1 instanceof c: " + (c1 instanceof c));
		log("c1 instanceof b: " + (c1 instanceof b));
		log("c2 instanceof c: " + (c2 instanceof c));
		log("c2 instanceof b: " + (c2 instanceof b));
	})();

	(function() {
		log();
		log("Object chaining using 'new' keyword:");

		function chainFrom(object) {
			var f = function() {};
			f.prototype = object;
			return new f();
		}

		var a = {
			name: "a",
			foo: function() { log(this.name + ".foo"); }
		};
		a.foo();

		var b = chainFrom(a);
		b.name = "b";
		b.bar = function() { log("b.bar"); };
		b.foo();
		b.bar();
	})();

	(function() {
		log();
		log("Object chaining using Object.create():");

		var a = {
			foo: function() { log("chained foo"); }
		};
		var b = Object.create(a);
		b.foo();
	})();

	(function() {
		log();
		log("Object chaining as a method:");

		var root = {
			chain: function() {
				return Object.create(this)
			}
		};

		var a = root.chain();
		a.foo = function() { log("chained foo"); };

		var b = a.chain();
		b.foo();
	})();

	(function() {
		log();
		log("Object chaining with constructors and parent calls:");

		var root = {
			chain: function(init) {
				var chained = Object.create(this);
				chained.parent = this;
				chained.init = init;
				chained.init();
				return chained;
			},
			init: function() {},
			chainedFrom: function(potentialParent) {
				var test = this;
				while(test) {
					if (test === potentialParent) return true;
					test = test.parent;
				}
				return false;
			}
		};

		log("A:");
		var a = root.chain(function() { log("a.init"); });
		a.name = "a";
		a.foo = function() { log("a.foo"); };
		a.printThis = function() { log("'this' is " + this.name) };
		a.foo();
		a.printThis();

		log("B:");
		var b = a.chain(function() { log("b.init"); });
		b.name = "b";
		b.bar = function() { log("b.bar"); };
		b.foo();
		b.bar();
		b.printThis();

		log("C:");
		var c = b.chain(function() { log("c.init"); this.parent.init(); });
		c.name = "c";
		c.bar = function() { log("c.bar"); this.parent.bar(); };
		c.foo();
		c.bar();
		c.printThis();

		log("Chained from:");
		log("c chained from {}? " + c.chainedFrom({}));
		log("c chained from c? " + c.chainedFrom(c));
		log("c chained from b? " + c.chainedFrom(b));
		log("c chained from a? " + c.chainedFrom(a));
		log("b chained from c? " + b.chainedFrom(c));
		log("b chained from b? " + b.chainedFrom(b));
		log("b chained from a? " + b.chainedFrom(a));
		log("a chained from c? " + a.chainedFrom(c));
		log("a chained from b? " + a.chainedFrom(b));
		log("a chained from a? " + a.chainedFrom(a));
	})();

	log();
	log("end");
});




	</script>

	<p>Output here:</p>
	<ol class="output">

	</ol>
</body>
</html>